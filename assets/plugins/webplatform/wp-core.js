(function(){var requirejs,require,define;(function(e){function n(e,n){if(e&&"."===e.charAt(0)&&n){n=n.split("/"),n=n.slice(0,n.length-1),e=n.concat(e.split("/"));var i,t;for(i=0;t=e[i];i++)if("."===t)e.splice(i,1),i-=1;else if(".."===t){if(1===i&&(".."===e[2]||".."===e[0]))break;i>0&&(e.splice(i-1,2),i-=2)}e=e.join("/")}return e}function i(n,i){return function(){return r.apply(e,c.call(arguments,0).concat([n,i]))}}function t(e){return function(i){return n(i,e)}}function a(e){return function(n){d[e]=n}}function o(n){if(p.hasOwnProperty(n)){var i=p[n];delete p[n],l.apply(e,i)}return d[n]}function s(e,i){var a,s,l=e.indexOf("!");return-1!==l?(a=n(e.slice(0,l),i),e=e.slice(l+1),s=o(a),e=s&&s.normalize?s.normalize(e,t(i)):n(e,i)):e=n(e,i),{f:a?a+"!"+e:e,n:e,p:s}}var l,r,d={},p={},c=[].slice;"function"!=typeof define&&(l=function(n,t,l,r){var c,u,m,f,h,v,y=[];if(r||(r=n),"function"==typeof l){for(!t.length&&l.length&&(t=["require","exports","module"]),f=0;t.length>f;f++)if(v=s(t[f],r),m=v.f,"require"===m)y[f]=i(n);else if("exports"===m)y[f]=d[n]={},c=!0;else if("module"===m)u=y[f]={id:n,uri:"",exports:d[n]};else if(d.hasOwnProperty(m)||p.hasOwnProperty(m))y[f]=o(m);else{if(!v.p)throw n+" missing "+m;v.p.load(v.n,i(r,!0),a(m),{}),y[f]=d[m]}h=l.apply(d[n],y),n&&(u&&u.exports!==e?d[n]=u.exports:c||(d[n]=h))}else n&&(d[n]=l)},requirejs=r=function(n,i,t,a){return"string"==typeof n?o(s(n,i).f):(n.splice||(i.splice?(n=i,i=arguments[2]):n=[]),a?l(e,n,i,t):setTimeout(function(){l(e,n,i,t)},15),r)},r.config=function(){return r},require||(require=r),define=function(e,n,i){n.splice||(i=n,n=[]),define.unordered?p[e]=[e,n,i]:l(e,n,i)},define.amd={jQuery:!0})})(),define("dependencies/almond/almond",function(){}),define("core/lib/error",["require","exports","module"],function(e,n,i){i.exports={wrap:function(e,n){return function(){try{return e.apply(null,arguments)}catch(i){var t="";void 0!==n&&(t=' (during "'+(n>=0?arguments[n]:n)+'")'),console.error(i.name+": "+i.message+t),console.log(i&&i.stack||i)}}},wrapAll:function(e,n){for(var t in e)"function"==typeof e[t]&&(e[t]=i.exports.wrap(e[t],n?n+t:t))}}}),define("core/lib/events",["require","exports","module","./error"],function(e,n,i){function t(e,n,t,a){if(a=a||[],!e)throw"type must be truthy";if(!n||null===n||"function"!=typeof n)throw"Could not add listener for event '"+e+"' "+(n?"this listener isn't a function":"this listener is undefined");s[e]=s[e]||[];for(var l=0;s[e].length>l;l++)if(s[e][l]&&s[e][l].origFunc===n)return console.warn("Could not add listener for event '"+e+"' this listener is already registered on this event"),void 0;0===s[e].length&&i.exports.emit("event.type.added",[e],!0),s[e].push({origFunc:n,func:o.wrap(n,e),once:!!t,paramMatch:a})}function a(e,n,i){i?e.func.apply(void 0,n):setTimeout(function(){e.func.apply(void 0,n)},1)}var o=e("./error"),s={};i.exports={on:function(e,n,i){t(e,n,!1,i)},once:function(e,n,i){t(e,n,!0,i)},emit:function(e,n,t){n=n||[],t=t||void 0===t,s[e]&&s[e].forEach(function(e,o,s){var l=e.paramMatch.every(function(e,t){return n[t]&&n[t].webviewId&&e?e.webviewId===n[t].webviewId:e===n[t]||e===i.exports.FILTER_ANY});l&&(a(e,n,t),e.once&&delete s[o])})},clear:function(e){e&&delete s[e]},un:function(e,n){e&&n&&s[e]&&(s[e]=s[e].filter(function(i){return!((i.func===n||i.origFunc===n)&&-1!==s[e].indexOf(i))}),0===s[e].length&&i.exports.emit("event.type.removed",[e],!0))},isOn:function(e){return s[e]?s[e]!==void 0&&0!==s[e].length:!1},FILTER_ANY:{}}}),define("core/lib/rpc/rpc.view",["require","exports","module","../events"],function(e,n,i){function t(e,n,i){i=i||{};var t={messageType:e};return t.messageType&&"string"==typeof t.messageType?(t.message=n,qnx.callExtensionMethod("webplatform.rpc",JSON.stringify(t)),void 0):Error("Message type is required")}function a(e,n){d.on("rpc."+e,n)}function o(e,n){d.once("rpc."+e,n)}function s(e,n){d.un("rpc."+e,n)}function l(e,n,i){d.emit("rpc."+e,n,i)}var r,d=e("../events");r={postMessage:t,on:a,un:s,once:o,emit:l},i.exports=r}),define("core/lib/pps/pps",["require","exports","module","../error"],function(e,n,i){function t(){var e=o++;return window.isFinite(e)||(o=0,e=0),e}var a,o=0,s={};a={PPSMode:{FULL:0,DELTA:1,SERVER:2,RAW:3},FileMode:{RDONLY:0,WRONLY:1,RDWR:2,CREATE:256},create:function(e,n){function i(){return s.hasOwnProperty(c)}function a(){delete s[c]}function o(e,n){var i=JSON.parse(qnx.callExtensionMethod("pps.open",c,u,m,e,n));return i.result?(s[c]=this,d=i.data,!0):!1}function l(e){return i()?"true"===qnx.callExtensionMethod("pps.write",c,JSON.stringify(e)):!1}function r(){i()&&qnx.callExtensionMethod("pps.close",c)}var d,p,c=t(),u=e,m=n;return p={open:o,write:l,close:r,onFirstReadComplete:void 0,onNewData:void 0,onOpenFailed:function(e){console.log("PPS Connection - open failed: "+e)},onWriteFailed:function(e){console.log("PPS Connection - write failed: "+e)},onClosed:a},p.__defineGetter__("mode",function(){return n}),p.__defineGetter__("data",function(){return d}),p.__defineGetter__("path",function(){return u}),p},onEvent:function(e,n,i){if(n&&s.hasOwnProperty(e)){var t=s[e],a="on"+n;t.hasOwnProperty(a)&&t[a]&&(("FirstReadComplete"===n||"NewData"===n)&&(i=JSON.parse(i),t._data=i),t[a](i))}}},e("../error").wrapAll(a,"pps."),i.exports=a}),define("core/lib/pps/jpps",["require","exports","module"],function(e,n,i){var t,a="libjpps",o=a+".PPS";t={create:function(){var e={m_strObjId:null,ppsObj:{}};return JNEXT.require(a)?(e.m_strObjId=JNEXT.createObject(o),""===e.m_strObjId?(console.error('JNext could not create the native PPS object "'+o+'". PPS is unavailable.'),!1):(e.open=function(n,i,t){var a=n+" "+i+(t?" "+t:""),o=JNEXT.invoke(e.m_strObjId,"Open",a),s=o.split(" ");return"Ok"!==s[0]?(console.error(o),!1):!0},e.read=function(){var n,i=JNEXT.invoke(e.m_strObjId,"Read"),t=i.split(" ");return"Ok"!==t[0]?(console.error(i),!1):(n=i.substr(t[0].length+1),e.ppsObj=JSON.parse(n),!0)},e.write=function(n){var i=JSON.stringify(n),t=JNEXT.invoke(e.m_strObjId,"Write",i),a=t.split(" ");return"Ok"!==a[0]?(console.error(t),!1):!0},e.close=function(){var n=JNEXT.invoke(e.m_strObjId,"Close");n=JNEXT.invoke(e.m_strObjId,"Dispose"),JNEXT.unregisterEvents(e)},e.getId=function(){return e.m_strObjId},e.onEvent=function(n){var i,t,a=n.split(" "),o=a[0];switch(o){case"Error":e.onError();break;case"OnChange":i=n.substr(o.length+1),t=JSON.parse(i),e.ppsObj=t.allData,e.ppsData={},e.ppsData[t.changeData.objName]=t.allData,null!==e.onChange&&e.onChange(t.changeData)}},e.onError=function(){console.error("PPS onError() handler.")},JNEXT.registerEvents(e),e)):(console.error('Unable to load "'+a+'". PPS is unavailable.'),!1)}},i.exports=t}),define("core/lib/pps/ppsUtils",["require","exports","module","./pps","./jpps"],function(e,n,i){var t,a=e("./pps"),o=e("./jpps");t={PPSMode:{FULL:0,DELTA:1,SERVER:2,RAW:4,WAIT:8},FileMode:{RDONLY:0,WRONLY:1,RDWR:2,CREATE:256},create:function(e,n){var i,s;return n===a.PPSMode.FULL?(i=a.create(e,n),i.onOpenFailed=function(e){i.onError(e)},i.onWriteFailed=function(e){i.onError(e)}):(s=function(){function i(e,n){var i=e,a=[];return n!==t.PPSMode.FULL&&((n|t.PPSMode.DELTA)===n&&a.push("delta"),a.length>=1&&(i+="?"+a.join(","))),i}var a,s,l,r=e.split("/").pop().split("?").shift(),d=i(e,n);return a=o.create(),l={open:function(e,n){var i=a.open(d,e,n);return i&&a.read()&&(s={},s[r]=a.ppsObj,this.onFirstReadComplete&&"function"==typeof this.onFirstReadComplete&&this.onFirstReadComplete(s)),i},write:function(e){return a.write(e)},close:function(){a.close()},onFirstReadComplete:void 0,onNewData:void 0,onClosed:void 0},l.__defineGetter__("mode",function(){return n}),l.__defineGetter__("data",function(){return a.ppsData||s}),l.__defineGetter__("path",function(){return d}),a.onChange=function(e){l.onNewData&&"function"==typeof l.onNewData&&l.onNewData(e)},l},i=s()),i},read:function(e,n){n=n||{};var i,t,o=n.ppsMode||a.PPSMode.FULL,s=n.fileMode||a.FileMode.RDONLY,l=this.create(e,o);if(l?l.open(s)?(l.close(),t=l.data):i="Failed to open PPS object with path "+e+" and with mode "+s:i="Failed to create a PPS object with path "+e+" and with mode "+o,i)throw i;return t},write:function(e,n,i){i=i||{};var o,s=i.ppsMode||a.PPSMode.FULL,l=i.fileMode||a.FileMode.RDWR,r=i.encode?i.encode:!1,d=this.create(n,s);if(d?d.open(l)?(e=r?t.encode(e):e,d.write(e)||(o="Failed to write data to PPS object with path "+n),d.close()):o="Failed to open PPS object with path "+n+" and with mode "+l:o="Failed to create a PPS object with path "+n+" and with mode "+s,o)throw o},encode:function(e){var n,i,t="";for(n in e)t+=n+":",i=e[n],"string"==typeof i?t+=":"+i:"number"==typeof i?t+="n:"+i:"boolean"==typeof i?t+="b:"+i:"object"==typeof i&&(t+="json:"+JSON.stringify(i)),t+="\n";return t},onEvent:a.onEvent},i.exports=t}),define("core/lib/invocation",["require","exports","module","./error"],function(e,n,i){function t(){var e=p++;return window.isFinite(e)||(p=0,e=0),e}function a(e){return e&&-1!==e.indexOf("local:///")?!0:!1}function o(e){return qnx.callExtensionMethod("application.getenv",e)}function s(e){var n=o("HOME");return a(e)&&(e="file:///"+n.replace(/^\/*/,"")+"/../app/native/"+e.replace(/local:\/\/\//,"")),e}var l,r,d,p=0,c={},u={};l={INVOKE_NO_TARGET_ERROR:"INVOKE_NO_TARGET_ERROR",INVOKE_BAD_REQUEST_ERROR:"INVOKE_BAD_REQUEST_ERROR",INVOKE_INTERNAL_ERROR:"INVOKE_INTERNAL_ERROR",INVOKE_TARGET_ERROR:"INVOKE_TARGET_ERROR",INVOKE_TARGET_NOT_OWNED_ERROR:"INVOKE_TARGET_NOT_OWNED_ERROR",QUERY_TARGETS_INVALID_ARGUMENT:"invalid_argument",QUERY_TARGETS_RESPONSE_TOO_LARGE:"response_too_large",QUERY_TARGETS_SERVER_ERROR:"server_error",LAUNCH:0,INVOKE:1,VIEWER:2,CARD:3,STARTUP_MODES_MAP:["launch","invoke","viewer","card"],InvokeAction:{OPEN:"bb.action.OPEN",SHARE:"bb.action.SHARE",VIEW:"bb.action.VIEW"},TARGET_TYPE_MASK_APPLICATION:1,TARGET_TYPE_MASK_CARD:2,TARGET_TYPE_MASK_VIEWER:0,TARGET_TYPE_MASK_SERVICE:8,TARGET_TYPE_MASK_HEADLESS:64,ACTION_TYPE_ALL:"ALL",ACTION_TYPE_MENU:"MENU",PERIMETER_TYPE_PERSONAL:"personal",PERIMETER_TYPE_ENTERPRISE:"enterprise",FILE_TRANSFER_PRESERVE:"PRESERVE",FILE_TRANSFER_COPY_RO:"COPY_RO",FILE_TRANSFER_COPY_RW:"COPY_RW",FILE_TRANSFER_LINK:"LINK",CARD_EDGE_TOP:"top_up",CARD_EDGE_BOTTOM:"bottom_up",CARD_EDGE_LEFT:"left_up",CARD_EDGE_RIGHT:"right_up",CARD_ORIENTATION_PORTRAIT:"portrait",CARD_ORIENTATION_LANDSCAPE:"landscape",CARD_PEEK_TYPE_CONTENT:"content",CARD_PEEK_TYPE_ROOT:"root",getStartupMode:function(){var e,n=o("uri");return"invoke://localhost"===n?(e=o("MODE"),"card"===e?l.CARD:"view"===e?l.VIEWER:l.INVOKE):l.LAUNCH},getRequest:function(){return qnx.callExtensionMethod("invocation.invokeRequest")},invoke:function(e,n,i){var s=t(),l=o("HOME")+"";a(e.uri)&&(e.uri="file:///"+l.replace(/^\/*/,"")+"/../app/native/"+e.uri.replace(/local:\/\/\//,"")),n&&(c[s]=n),"function"==typeof d&&i?d(e,function(e){"object"==typeof e&&qnx.callExtensionMethod("invocation.invoke",s,JSON.stringify(e))}):qnx.callExtensionMethod("invocation.invoke",s,JSON.stringify(e))},invokeViewer:function(e,n){var i,a=t();n&&(c[a]=n),i="viewer"+a,e.winid=i,qnx.callExtensionMethod("invocation.invokeViewer",a,i,JSON.stringify(e))},queryTargets:function(e,n){var i=t(),a="viewer"+i;c[i]=n,e.winid=a,e.hasOwnProperty("uri")&&(e.uri=s(e.uri)),qnx.callExtensionMethod("invocation.queryTargets",i,JSON.stringify(e))},cardResized:function(){r&&qnx.callExtensionMethod("invocation.cardResize",r)},cardPeek:function(e){qnx.callExtensionMethod("invocation.cardPeek",e)},closeChildCard:function(){qnx.callExtensionMethod("invocation.cardChildClose")},sendCardDone:function(e){qnx.callExtensionMethod("invocation.cardClose",JSON.stringify(e))},getInvokeTargetFilters:function(e,n){var i,a=t();c[a]=n,i={target:e},qnx.callExtensionMethod("invocation.getInvokeTargetFilters",a,JSON.stringify(i))},setInvokeTargetFilters:function(e,n){var i=t();n&&(c[i]=n),qnx.callExtensionMethod("invocation.setInvokeTargetFilters",i,JSON.stringify(e))},onInvoked:function(e){wp.core.events.emit("invocation.invoked",[e])},onInvokeResponse:function(e,n,i){var t,a=c[e];if(a){delete c[e];try{t=JSON.parse(i)}catch(o){t=null}a(n,t)}},onInvokeViewerResponse:function(e,n){if(n){var i=c[e];delete c[e],i&&i(n)}},onQueryTargetsResponse:function(e,n,i){var t,a=c[e];if(a){delete c[e];try{t=JSON.parse(i)}catch(o){t=null}a(n,t)}},onViewerCreate:function(e,n){var i,a=c[e];delete c[e],i={viewerId:n,relayCallbacks:{},close:function(){qnx.callExtensionMethod("invocation.closeViewer",this.viewerId)},receive:function(e,n){var i=n.msg;"viewerCloseRequest"===i?(this.close(),this.hasOwnProperty("onClose")&&this.onClose()):"viewerCancelRequest"===i?(this.close(),this.hasOwnProperty("onCancel")&&this.onCancel()):this.hasOwnProperty("onReceive")&&this.onReceive(e,n.msg,n.dat)},receiveResponse:function(e,n){var i=this.relayCallbacks[e];delete this.relayCallbacks[e],i&&i(n.name,n.dat)},setSize:function(e,n){var i={msg:"resizeReqeust",data:{width:e,height:n}};this.send(JSON.stringify(i))},setPosition:function(e,n){qnx.callExtensionMethod("invocation.setViewerPosition",this.viewerId,e,n)},setVisibility:function(e){qnx.callExtensionMethod("invocation.setViewerVisibility",this.viewerId,e)},setZOrder:function(e){qnx.callExtensionMethod("invocation.setViewerZOrder",this.viewerId,e)},send:function(e,n){var i=t();n&&(this.relayCallbacks[i]=n),e.winid=this.viewerId,qnx.callExtensionMethod("invocation.viewerRelay",i,e)},update:function(){qnx.callExtensionMethod("applicationWindow.flushContext")}},u[i.viewerId]=i,a(null,i)},onViewerRelay:function(e,n){try{var i=JSON.parse(n),t=u[i.winId];t&&t.receive(e,i)}catch(a){}},onViewerRelayResponse:function(e,n){try{var i=JSON.parse(n),t=u[i.winId];t&&t.receiveResponse(e,i)}catch(a){}},onViewerStopped:function(e){delete u[e]},onCardResize:function(e,n){var i=n.split(","),t={width:i[0],height:i[1],orientation:i[2],edge:i[3]};r=e,wp.core.events.emit("invocation.cardResize",[t])},onCardStartPeek:function(e){wp.core.events.emit("invocation.cardPeekStarted",[e])},onCardEndPeek:function(){wp.core.events.emit("invocation.cardPeekEnded")},onCardChildOpened:function(){wp.core.events.emit("invocation.childCardOpened")},onCardChildClosed:function(e){var n;try{n=JSON.parse(e)}catch(i){n={reason:"",type:"",data:""}}wp.core.events.emit("invocation.childCardClosed",[n])},onCardClosed:function(e){var n;try{n=JSON.parse(e)}catch(i){n={reason:"",type:"",data:""}}wp.core.events.emit("invocation.cardClosed",[n])},onGetInvokeTargetFiltersResponse:function(e,n,i){var t,a=c[e];if(a){delete c[e];try{t=JSON.parse(i)}catch(o){t=null}a(n,t)}},onSetInvokeTargetFiltersResponse:function(e,n,i){var t,a=c[e];if(a){delete c[e];try{t=JSON.parse(i)}catch(o){t=null}a(n,t)}},on:function(e,n){var i="invocation."+e.charAt(0).toLowerCase()+e.slice(1);wp.core.events.on(i,n)},un:function(e,n){var i="invocation."+e.charAt(0).toLowerCase()+e.slice(1);wp.core.events.un(i,n)}},e("./error").wrapAll(l,"invocation."),l.__defineGetter__("startupMode",function(){return l.getStartupMode()}),l.__defineGetter__("invokeRequest",function(){var e=l.getRequest();if(e)try{return JSON.parse(e)}catch(n){return null}return null}),l.__defineGetter__("interrupter",function(){return d}),l.__defineSetter__("interrupter",function(e){d=e}),i.exports=l}),define("core/lib/rpc/rpc",["require","exports","module"],function(require,exports,module){function postMessage(e,n,i){var t,a;return n&&"string"==typeof n?(t=void 0===i?"":"object"==typeof i?JSON.stringify(i):"'"+i+"'",a="wp.view.rpc.emit('"+n+"', ["+t+"])",e.executeJavaScript(a),void 0):Error("Message type is required")}function handleJSCallback(webView,webViewOptions,value){var args=eval(JSON.parse(value).args),command=args[0],info,eventOptions={};"webplatform.rpc"===command&&(info=JSON.parse(args[1]),webView.rpc.emit(info.messageType,[info.message],eventOptions))}function on(e,n,i){e.on("rpc."+n,i)}function once(e,n,i){e.once("rpc."+n,i)}function un(e,n,i){e.un("rpc."+n,i)}function emit(e,n,i,t){e.emit("rpc."+n,i,t)}function enableRpcOn(e){e.isWebEventAllowed("JavaScriptCallback")||(e.allowQnxObject=!0,e.on("JavaScriptCallback",handleJSCallback.bind(null,e)))}function disableRpcOn(e){e.isWebEventAllowed("JavaScriptCallback")&&(e.allowQnxObject=!1,e.un("JavaScriptCallback",handleJSCallback.bind(null,e)))}var rpc;rpc={postMessage:postMessage,on:on,un:un,once:once,emit:emit,enableRpcOn:enableRpcOn,disableRpcOn:disableRpcOn},module.exports=rpc}),define("core/lib/automation/main",["require","exports","module","./../events","../pps/pps","./../rpc/rpc"],function(e,n,i){var t,a,o,s,l,r=e("./../events"),d=e("../pps/pps"),p=e("./../rpc/rpc"),c=!1,u=!1,m=!1,f="webDriverCoreScript",h=function(e){if(!m){var n=document.createElement("script");n.type="text/javascript",n.id=f,n.onload=function(){o=seleniumCoreRequire("main"),o.init(),e&&e()},n.src="platform:///seleniumCore.js",document.getElementsByTagName("head")[0].appendChild(n),m=!0,u=!0}},v=function(e){s=e},y=function(){if(t=d.create("/pps/browser/control",d.PPSMode.DELTA),a=d.create("/pps/browser/output",d.PPSMode.FULL),t.onFirstReadComplete=v,t.open(d.FileMode.RDONLY)&&a.open(d.FileMode.WRONLY)){var e=function(){c=!0,o.output=a.write,t.onNewData=o.ppsNewData,s?o.ppsNewData(s):t.onFirstReadComplete=o.ppsNewData,o.closePPS=l.close};h(e)}},g=function(){var e,n,i,t=d.create("/pps/services/automation/browser/output",d.PPSMode.FULL);t.open(d.FileMode.WRONLY)&&(e=window.require("iris/tabs/controller"),r.on("webpage.load.progress",function(t,a){a>=90&&(i=e.get(t),qnx.callExtensionMethod("webview.automationLog",window.iris.chromeId,"progressBarDisappears"),n="Navigation Request: old url="+i.oldUrl+" new url="+i.url+" webviewId= "+i.webviewId,console.log(n))}),t.close())};l={init:h,rpc:p,dinit:function(){var e=document.getElementById(f);e&&e.parentNode.removeChild(e),c=!1,m=!1,u=!1,o=0},close:function(){t.close(),a.close()}},r.once("automation.init",y),r.once("automation.init",g),i.exports=l}),define("core/lib/core",["require","exports","module","./events","./pps/ppsUtils","./invocation","./error","./automation/main"],function(e,n,i){i.exports={events:e("./events"),pps:e("./pps/ppsUtils"),invocation:e("./invocation"),error:e("./error"),automation:e("./automation/main")}}),define("core/lib/main",["require","exports","module","./rpc/rpc.view","./core","./automation/main"],function(e){window.wp||(window.wp={}),window.wp.view||(window.wp.view={}),window.wp.view.rpc=e("./rpc/rpc.view"),window.wp.core=e("./core"),window.wp.core.automation=e("./automation/main")}),require(["./core/lib/main"])})();
//@ sourceMappingURL=wp-core.js.map